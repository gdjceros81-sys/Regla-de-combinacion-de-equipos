<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infografía de Equipos Mesh</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Carga de la fuente Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        /* Aplicamos la fuente Inter a todo el cuerpo */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Estilo para las tarjetas de marca */
        .brand-card {
            background-color: #1f2937; /* bg-gray-800 */
            border-radius: 1rem; /* rounded-xl */
            padding: 1.5rem; /* p-6 */
            border: 1px solid #374151; /* border-gray-700 */
            transition: all 0.3s ease-in-out;
        }
        .brand-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); /* shadow-xl */
        }

        /* --- INICIO: Estilos para el Asistente Gemini --- */

        /* Estilo para el botón del asistente con resplandor */
        .gemini-button {
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5), 0 0 5px rgba(59, 130, 246, 0.3);
            animation: pulse-glow 2s infinite alternate;
        }
        .gemini-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.7), 0 0 10px rgba(59, 130, 246, 0.5);
        }

        @keyframes pulse-glow {
            from {
                box-shadow: 0 0 15px rgba(59, 130, 246, 0.4), 0 0 5px rgba(59, 130, 246, 0.2);
            }
            to {
                box-shadow: 0 0 25px rgba(59, 130, 246, 0.7), 0 0 10px rgba(59, 130, 246, 0.5);
            }
        }

        /* Estilos para el Modal */
        .modal {
            display: none; /* Oculto por defecto */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
        }
        .modal-content {
            position: relative;
            background-color: #1f2937; /* bg-gray-800 */
            margin: 10% auto;
            padding: 2rem;
            border: 1px solid #374151; /* border-gray-700 */
            width: 90%;
            max-width: 600px;
            border-radius: 1rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            animation: slide-in 0.3s ease-out;
        }

        @keyframes slide-in {
            from {
                transform: translateY(-30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            line-height: 1;
        }
        .modal-close:hover,
        .modal-close:focus {
            color: #fff;
            text-decoration: none;
            cursor: pointer;
        }

        /* Estilo para el área de respuesta y loader */
        #gemini-response {
            background-color: #111827; /* bg-gray-900 */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1rem;
            margin-top: 1rem;
            min-height: 150px;
            white-space: pre-wrap; /* Respeta saltos de línea y espacios */
            overflow-y: auto;
            max-height: 300px;
            border: 1px solid #374151;
            font-family: 'Inter', sans-serif;
            color: #d1d5db; /* text-gray-300 */
        }

        /* Loader */
        .loader {
            border: 4px solid #374151; /* border-gray-700 */
            border-top: 4px solid #3b82f6; /* border-blue-500 */
            border-radius: 50%;
            width: 32px;
            height: 32px;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
            display: none; /* Oculto por defecto */
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* --- FIN: Estilos para el Asistente Gemini --- */
    </style>
</head>
<body class="bg-gray-900 text-gray-200 leading-relaxed">

    <main class="container mx-auto p-6 sm:p-12">

        <!-- Encabezado -->
        <header class="text-center mb-12">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-white mb-4">
                COMBINACIÓN DE ONTS Y ACCESS POINTS
            </h1>
            <p class="text-lg md:text-xl text-gray-400 mt-4 max-w-3xl mx-auto">
                Guía de instalación y compatibilidad para equipos Mesh.
            </p>

            <!-- INICIO: Botón del Asistente Gemini -->
            <div class="mt-8">
                <button id="open-gemini-modal" class="gemini-button bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg flex items-center justify-center mx-auto">
                    <!-- Icono de chispas -->
                    <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM18 13.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 18l-1.035.259a3.375 3.375 0 00-2.456 2.456L18 21.75l-.259-1.035a3.375 3.375 0 00-2.456-2.456L14.25 18l1.036-.259a3.375 3.375 0 002.455-2.456L18 13.25z" />
                    </svg>
                    ✨ Asistente de Configuración Mesh
                </button>
            </div>
            <!-- FIN: Botón del Asistente Gemini -->

        </header>

        <!-- Sección: Wifi-6 -->
        <section class="mb-16">
            <h2 class="text-xl sm:text-2xl font-bold text-white border-b-2 border-blue-500 pb-2 mb-8">Tecnología: Wifi-6</h2>
            
            <!-- Grid para los fabricantes de Wifi-6 -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                
                <!-- Tarjeta: ZTE -->
                <div class="brand-card" style="box-shadow: 0 0 25px rgba(34, 211, 238, 0.1);">
                    <h3 class="text-2xl font-semibold text-white mb-6 border-b border-gray-700 pb-3">ZTE</h3>
                    <div class="space-y-6">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <!-- Icono ONT -->
                                <svg class="w-6 h-6 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-cyan-300">F6221B</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <!-- Icono AP -->
                                <svg class="w-6 h-6 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-cyan-300">H3101P</p>
                                </div>
                            </div>
                        </div>
                        <hr class="border-gray-700">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-cyan-300">F6201B</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-cyan-300">H3101P</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tarjeta: Huawei -->
                <div class="brand-card" style="box-shadow: 0 0 25px rgba(34, 211, 238, 0.1);">
                    <h3 class="text-2xl font-semibold text-white mb-6 border-b border-gray-700 pb-3">Huawei</h3>
                    <div class="space-y-6">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-cyan-300">HG8245X68</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-cyan-300">K562e-10</p>
                                </div>
                            </div>
                        </div>
                        <hr class="border-gray-700">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-cyan-300">HG8145X610</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-cyan-300">K562e-10</p>
                                </div>
                            </div>
                        </div>
                        <hr class="border-gray-700">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-cyan-300">HG8145X612</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-cyan-300">K562e-10</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tarjeta: Nokia (Vacía para Wifi-6) -->
                <div class="brand-card border-dashed border-gray-700 bg-gray-800/50">
                    <h3 class="text-2xl font-semibold text-white mb-6 border-b border-gray-700 pb-3">Nokia</h3>
                    <div class="flex items-center justify-center h-full">
                        <p class="text-gray-500 italic">Sin datos para Wifi-6</p>
                    </div>
                </div>

            </div>
        </section>

        <!-- Sección: Wifi-5 -->
        <section>
            <h2 class="text-xl sm:text-2xl font-bold text-white border-b-2 border-blue-500 pb-2 mb-8">Tecnología: Wifi-5</h2>
            
            <!-- Grid para los fabricantes de Wifi-5 -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                
                <!-- Tarjeta: ZTE -->
                <div class="brand-card" style="box-shadow: 0 0 25px rgba(163, 230, 53, 0.1);">
                    <h3 class="text-2xl font-semibold text-white mb-6 border-b border-gray-700 pb-3">ZTE</h3>
                    <div class="space-y-6">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-lime-300">F679W</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-lime-300">H199A</p>
                                </div>
                            </div>
                        </div>
                        <hr class="border-gray-700">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-lime-300">F680V90</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-lime-300">H199A</p>
                                </div>
                            </div>
                        </div>
                        <hr class="border-gray-700">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-lime-300">F670LV11</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-lime-300">H199A</p>
                                </div>
                            </div>
                        </div>
                        <hr class="border-gray-700">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-lime-300">F679LV9</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-lime-300">H199A</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tarjeta: Huawei -->
                <div class="brand-card" style="box-shadow: 0 0 25px rgba(163, 230, 53, 0.1);">
                    <h3 class="text-2xl font-semibold text-white mb-6 border-b border-gray-700 pb-3">Huawei</h3>
                    <div class="space-y-6">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-lime-300">HG8145V512</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-lime-300">WA8021V5</p>
                                </div>
                            </div>
                        </div>
                        <hr class="border-gray-700">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-lime-300">HG8245W5</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-lime-300">WA8021V5</p>
                                </div>
                            </div>
                        </div>
                        <hr class="border-gray-700">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-lime-300">HG8145V5</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-lime-300">WA8021V5</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tarjeta: Nokia -->
                <div class="brand-card" style="box-shadow: 0 0 25px rgba(163, 230, 53, 0.1);">
                    <h3 class="text-2xl font-semibold text-white mb-6 border-b border-gray-700 pb-3">Nokia</h3>
                    <div class="space-y-6">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-lime-300">G1425G8</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-lime-300">Beacon 1-1</p>
                                </div>
                            </div>
                        </div>
                        <hr class="border-gray-700">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-lime-300">G1425GA</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-lime-300">Beacon 1-1</p>
                                </div>
                            </div>
                        </div>
                        <hr class="border-gray-700">
                        <!-- Par de combinación -->
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3m16.5 0h.008v.008h-.008v-.008z" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">ONT</span>
                                    <p class="text-lg font-mono text-lime-300">G2425G8</p>
                                </div>
                            </div>
                            <!-- Flecha eliminada -->
                            <div class="flex items-center space-x-3">
                                <svg class="w-6 h-6 text-lime-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-2.1h7.126a3.375 3.375 0 012.7 2.1l.094.4a4.5 4.5 0 01.9 2.7m-19.5 0h19.5" /></svg>
                                <div>
                                    <span class="text-xs font-medium text-gray-400 uppercase">Access Point</span>
                                    <p class="text-lg font-mono text-lime-300">Beacon 1-1</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <!-- Pie de página -->
        <footer class="text-center mt-16 text-gray-500 text-sm">
            <p>Información basada en la tabla de compatibilidad proporcionada.</p>
        </footer>

    </main>

    <!-- INICIO: Modal del Asistente Gemini -->
    <div id="gemini-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="close-gemini-modal">&times;</span>
            <h3 class="text-2xl font-semibold text-white mb-4 flex items-center">
                <svg class="w-6 h-6 mr-2 text-blue-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM18 13.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 18l-1.035.259a3.375 3.375 0 00-2.456 2.456L18 21.75l-.259-1.035a3.375 3.375 0 00-2.456-2.456L14.25 18l1.036-.259a3.375 3.375 0 002.455-2.456L18 13.25z" />
                </svg>
                Asistente de Configuración Mesh
            </h3>
            <p class="text-gray-400 mb-4">
                Describe tu problema o qué equipos quieres configurar.
                <br>
                <em class="text-sm text-gray-500">Ej: "¿Cómo configuro un ZTE F679W con un H199A?"</em>
            </p>

            <textarea id="gemini-prompt" class="w-full h-24 bg-gray-700 text-gray-200 p-2 rounded-lg border border-gray-600 focus:ring-blue-500 focus:border-blue-500" placeholder="Escribe tu consulta aquí..."></textarea>
            
            <button id="gemini-submit" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg mt-4 transition duration-200">
                Generar Guía
            </button>

            <div id="gemini-loader" class="loader"></div>

            <div id="gemini-response" class="text-gray-300">
                Tu guía de configuración aparecerá aquí...
            </div>
        </div>
    </div>
    <!-- FIN: Modal del Asistente Gemini -->


    <!-- INICIO: Lógica del Asistente Gemini -->
    <script type="module">
        // --- Constantes de la API ---
        const apiKey = "AIzaSyAouVfN_En34vqWIUfigq4lx-Fn-ncWHpk"; // Dejar vacío, se proveerá en runtime
        const systemPrompt = `
Eres un asistente experto en redes y técnico de telecomunicaciones, especializado en equipos ZTE, Huawei y Nokia.
Tu tarea es proporcionar guías de configuración claras, concisas y paso a paso.
El usuario te hará una consulta sobre cómo configurar o solucionar problemas de una combinación de ONT y Access Point.
Responde ÚNICAMENTE con la guía. No saludes, no uses introducciones ni despedidas. Ve directo a los pasos.
Usa formato markdown simple, como guiones (-) o listas numeradas (1., 2., 3.).
`;
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

        // --- Constantes del DOM (¡AÑADIDAS!) ---
        const modal = document.getElementById('gemini-modal');
        const openModalBtn = document.getElementById('open-gemini-modal');
        const closeModalBtn = document.getElementById('close-gemini-modal');
        const submitBtn = document.getElementById('gemini-submit');
        const promptInput = document.getElementById('gemini-prompt');
        const responseDiv = document.getElementById('gemini-response');
        const loader = document.getElementById('gemini-loader');

        // --- Contraseña ---
        const ADMIN_PASSWORD = "config2024"; // Puedes cambiar esta contraseña

        // --- Event Listeners ---
        openModalBtn.addEventListener('click', checkPasswordAndShowModal); // Modificado
        closeModalBtn.addEventListener('click', hideModal);
        
        // **INICIO: CÓDIGO CORREGIDO**
        // Lógica para cerrar el modal si se hace clic fuera de él
        window.addEventListener('click', (event) => {
            if (event.target == modal) {
                hideModal();
            }
        });
        // **FIN: CÓDIGO CORREGIDO**

        submitBtn.addEventListener('click', getGeminiResponse);

        // --- Funciones del Modal ---

        /**
         * Nueva función para verificar la contraseña antes de mostrar el modal
         */
        function checkPasswordAndShowModal() {
            const enteredPassword = prompt("Por favor, introduce la contraseña para acceder al asistente:");
            
            // Verificar si el usuario ingresó algo y si coincide
            if (enteredPassword === ADMIN_PASSWORD) {
                showModal();
            } else if (enteredPassword !== null && enteredPassword !== "") {
                // El usuario escribió algo pero era incorrecto.
                // No usamos alert(), así que simplemente no abrimos el modal.
                console.warn("Contraseña incorrecta.");
            }
            // Si el usuario presiona "Cancelar" (enteredPassword es null), no se hace nada.
        }

        function showModal() {
            modal.style.display = 'block';
            // **INICIO: CÓDIGO CORREGIDO**
            // Se eliminó el comentario malformado que estaba aquí
            // **FIN: CÓDIGO CORREGIDO**
        }

        function hideModal() {
            modal.style.display = 'none';
            // Resetea el modal al cerrar
            promptInput.value = '';
            responseDiv.innerHTML = 'Tu guía de configuración aparecerá aquí...';
            responseDiv.style.display = 'block';
            loader.style.display = 'none';
            submitBtn.disabled = false;
            submitBtn.innerHTML = 'Generar Guía';
        }

        // --- Funciones de la API de Gemini ---

        /**
         * Función para reintentar la llamada fetch con backoff exponencial.
         * @param {number} maxRetries - Número máximo de reintentos.
         * @returns {Promise<Response>}
         */
        async function fetchWithBackoff(url, options, maxRetries = 3) {
            let attempt = 0;
            let delay = 1000; // 1 segundo inicial

            while (attempt < maxRetries) {
                try {
                    const response = await fetch(url, options);
                    if (response.ok) {
                        return response;
                    }
                    // Si la respuesta no es 'ok' pero no es un error de red (ej. 404, 500)
                    // no reintentamos, simplemente lanzamos el error para que sea manejado.
                    if (response.status >= 400 && response.status < 500) {
                         console.error(`Error ${response.status} del cliente. No se reintentará.`);
                         throw new Error(`Error ${response.status}: ${response.statusText}`);
                    }
                    // Si es un error de servidor (5xx) o un código de reintento (429), reintentamos.
                    console.warn(`Intento ${attempt + 1} fallido. Reintentando en ${delay}ms...`);

                } catch (error) {
                    // Este catch maneja errores de red (ej. 'Failed to fetch')
                    console.warn(`Intento ${attempt + 1} fallido (error de red). Reintentando en ${delay}ms...`);
                }

                await new Promise(resolve => setTimeout(resolve, delay));
                delay *= 2; // Duplica el retraso para el siguiente intento
                attempt++;
            }

            // Si todos los reintentos fallan, lanza el error final.
            throw new Error(`No se pudo obtener la respuesta de la API después de ${maxRetries} intentos.`);
        }


        /**
         * Llama a la API de Gemini y muestra la respuesta.
         */
        async function getGeminiResponse() {
            const userQuery = promptInput.value;
            if (!userQuery) {
                // No usamos alert()
                responseDiv.innerHTML = 'Por favor, introduce una consulta.';
                return;
            }

            // Mostrar loader y ocultar/deshabilitar elementos
            loader.style.display = 'block';
            responseDiv.style.display = 'none';
            submitBtn.disabled = true;
            submitBtn.innerHTML = 'Generando...';

            const payload = {
                contents: [{
                    parts: [{ text: userQuery }]
                }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
                generationConfig: {
                    // Configuración opcional
                    temperature: 0.5,
                    topK: 40,
                }
            };

            try {
                const response = await fetchWithBackoff(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0 && result.candidates[0].content.parts[0].text) {
                    const text = result.candidates[0].content.parts[0].text;
                    // Limpiamos el HTML para evitar inyecciones, aunque el markdown simple es seguro.
                    // Para este caso, como esperamos markdown simple, podemos reemplazar saltos de línea con <br>
                    // o usar `white-space: pre-wrap;` (que ya está en el CSS).
                    responseDiv.textContent = text; // .textContent es más seguro que .innerHTML
                } else {
                    throw new Error("Respuesta inesperada de la API.");
                }

            } catch (error) {
                console.error("Error al llamar a la API de Gemini:", error);
                responseDiv.textContent = `Error: No se pudo obtener la respuesta. Por favor, inténtalo de nuevo.\nDetalles: ${error.message}`;
            } finally {
                // Ocultar loader y restaurar elementos
                loader.style.display = 'none';
                responseDiv.style.display = 'block';
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'Generar Guía';
            }
        }
    </script>
    <!-- FIN: Lógica del Asistente Gemini -->

</body>
</html>

